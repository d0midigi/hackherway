<h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">NETWORK CONFIGURATION</span></h2><div><span style="font-family: Poppins;">The network configuration of an infiltrated system can reveal additional subnets, network routers, essential servers, name servers, and the interconnections between machines. This intelligence can be utilized to pinpoint further targets for deeper access into the target network.</span></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;">Interfaces<br /><br /></span></li><li><span style="font-family: Poppins;">Catalog all network interfaces present on the system, including their respective IP addresses, subnet masks, and gateways.</span></li></ul><span style="font-family: Poppins;">By analyzing these interfaces and their configurations, it becomes possible to prioritize networks and services for targeted actions.</span></div><div><h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">ROUTING</span></h2></div><div><span style="font-family: Poppins;">Understanding other subnets, as well as filtering or addressing schemes, may facilitate navigation beyond a segmented network uncovering additional hosts and/or networks for exploration and enumeration. This information can be sourced from various elements within a specific host or network, such as:</span></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;">Interfaces<br /><br /></span></li><li><span style="font-family: Poppins;">Routing tables encompassing both static and dynamic routes<br /><br /></span></li><li><span style="font-family: Poppins;">ARP Tables,&nbsp;NetBIOS, or other network protocols utilized for service and host discovery<br /><br /></span></li><li><span style="font-family: Poppins;">For hosts with multiple network interfaces, ascertain whether they function as routers.</span></li></ul><div><h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">DNS SERVERS</span></h2></div></div><div><span style="font-family: Poppins;">Identify all active DNS servers by evaluating host configurations. The information from DNS servers can be instrumental in formulating and executing a strategy to uncover further hosts and services within the target network. If a DNS server is compromised, its database can yield critical insights into hosts and services, aiding in the prioritization of targets for the ongoing assessment. Additionally, the alteration and introduction of new records could facilitate the interception of data from services reliant on DNS.</span></div><h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">CACHED DNS ENTRIES</span></h2><div><span style="font-family: Poppins;">Identify valuable DNS entries stored in the cache, which may encompass login pages for Intranet sites, management interfaces, or external websites. Cached interfaces reveal information about the most recent and frequently accessed hosts by the compromised system, offering insights into the relationships and interactions among hosts. This information can be instrumental in prioritizing targets for further penetration of the target network and infrastructure. If modifications to cached entries are permitted, they can be exploited to capture authentication credentials, tokens, or to gather additional information regarding services utilized by the compromised hosts, facilitating further penetration into the target network.</span></div><h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">PROXY SERVERS</span></h2><div><span style="font-family: Poppins;">Identify both network and application-level proxy servers. Proxy servers represent significant targets, particularly when utilized across the enterprise by clients. In the context of application proxies, it may be feasible to identify, modify, and/or monitor the flow of traffic or the traffic itself. Attacks on proxy servers are often an effective method to demonstrate impact and risk to the client.</span></div><h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">ARP ENTRIES</span></h2><div><span style="font-family: Poppins;">Enumerate both cached and static ARP table entries, which can disclose other hosts interacting with the compromised machine. Static ARP entries may indicate critical machines. If the assessment's scope permits the interception and modification of ARP entries, it becomes pretty straightforward to demonstrate the potential for disrupting, monitoring, or compromising a service in a manner that typically goes undetected or unprotected.</span></div><h1 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">NETWORK SERVICES</span></h1><h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">LISTENING SERVICES</span></h2><div><span style="font-family: Poppins;">Identify all network services provided by the target machine. This process may uncover services that were not detected during initial scanning, as well as reveal other machines and networks. The identification of services absent from scanning results can also yield insights into potential filtering and control systems implemented within the network and/or host. Furthermore, the tester may be able to leverage these services to compromise additional machines. Most operating systems include methods for identifying TCP and UDP services, however.</span></div><h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">PILLAGING</span></h2><div><span style="font-family: Poppins;">Pillaging involves the acquisition of sensitive information, such as files containing personal data, credit card details, passwords, and more, from specific hosts that align with the objectives established during the pre-assessment phase. This information may be utilized to achieve defined goals or as part of a strategy to navigate further into the network. The location of such data can differ based on the type of information, the role of the host, and various other factors. A solid understanding and familiarity with commonly utilized applications, server software, and middleware are crucial, as these applications often store data in diverse formats and locations. In some cases, specialized tools may be required to obtain, extract, or interpret the targeted data from certain systems.</span></div><h1 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">INSTALLED PROGRAMS</span></h1><h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">STARTUP ITEMS</span></h2><div><span style="font-family: Poppins;">Typically, systems will have applications that initiate during system startup or user logon, which can provide insights into the system's purpose, the software it utilizes, and the services it interacts with. This information may indicate potential security measures that could impede further exploitation of the target network and its systems (e.g. Host Intrusion Detection Systems (HIDS), Host Intrusion Prevention Systems (HIPS), Application Allowlisting, File Integrity Monitoring (FIM). The information to be collected should include:</span></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;">A list of applications along with their respective versions installed on the system<br /><br /></span></li><li><span style="font-family: Poppins;">A list of operating system updates that have been applied to the system</span></li></ul><h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">INSTALLED SERVICES</span></h2></div><div><span style="font-family: Poppins;">Services present on a specific host may either support the host itself or provide functionality to other hosts within the target network. It is essential to develop a profile for each targeted host, documenting the configuration of these services, their intended functions, and their potential applications in achieving assessment objectives or further infiltrating the network.</span></div><h2 style="text-align: left;"><span style="font-family: Oswald; font-weight: normal;">SECURITY SERVICES</span></h2><div><span style="font-family: Poppins;">Security services consist of software solutions aimed at preventing unauthorized access to systems and safeguarding data. This category includes, but is not limited to, network firewalls, host-based firewalls, intrusion detection and prevention systems (IDS/IPS), host intrusion detection and prevention systems (HIDS/HIPS), and antivirus software. Identifying the security services present on a specific targeted host can provide insights into what may be encountered when assessing other machines within the network. Additionally, it can indicate which alerts may have been activated during the assessment, facilitating discussions with the client during the project debrief. This may lead to revisions in Security Policies, User Account Control (UAC), SELinux, IPSec, Window security templates, or other security rules and configurations.</span></div><div><h2><span style="font-family: Oswald; font-weight: normal;">DATABASE SERVICES</span></h2></div><div><span style="font-family: Poppins;">Databases house extensive information that may be relevant during an assessment.</span></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Databases</span></b> - Compiling a list of databases names assists the assessor in understanding the database's purpose and the types of data it may hold. In environments with numerous databases, this information aids in prioritizing assessment targets.<br /><br /></span></li><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Tables</span></b> - The names and metadata of tables, including comments, column names, and data types, can guide the assessor in selecting targets and identifying specific data of interest.<br /><br /></span></li><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Table Content</span></b> - The row count for regulated content is also significant.<br /><br /></span></li><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Columns</span></b> - In many database systems, it is feasible to execute a single command to search all column names across all tables. This capability can be utilized to locate specific data (for instance, if targeting credit card information in an Oracle database, one might execute </span><span style="font-family: JetBrains Mono;">select * from all_tab_columns where name = '%CCN%</span><span style="font-family: Poppins;">';).<br /><br /></span></li><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Database and Table Permissions<br /><br /></span></b></span></li><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Database Users, Passwords, Groups, and Roles</span></b></span></li></ul><div><span style="font-family: Poppins;">The data stored within databases can also be instrumental in illustrating risk, achieving assessment objectives, determining service configurations, and functionalities, or facilitating deeper penetration into a client's network and hosts.</span></div></div><div><h2><span style="font-family: Oswald; font-weight: normal;">DIRECTORY SERVICES</span></h2></div><div><span style="font-family: Poppins;">The primary objective of a directory service is to provide critical information to services and hosts for reference and/or authentication. If this service is compromised, it could result in the control of all dependent hosts and potentially offer valuable information that could be leveraged to advance an attack. Key information to monitor in a directory service includes:</span></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;">Lists of objects (users, passwords, machines)<br /><br /></span></li><li><span style="font-family: Poppins;">Active system connections<br /><br /></span></li><li><span style="font-family: Poppins;">Identifying protocols and security levels</span></li></ul><div><h2><span style="font-family: Oswald; font-weight: normal;">NAME SERVERS</span></h2></div></div><div><span style="font-family: Poppins;">Name servers resolve hostnames and services based on the type of records they manage. Enumeration of these records and controls can provide a list of targets and services, helping attackers prioritize and execute further penetration into a target network or endpoint. The ability to modify and add records can also pose risks, including denial of service (DoS) attacks and facilitating the interception of network traffic and information.</span></div><div><h2><span style="font-family: Oswald; font-weight: normal;">DEPLOYMENT SERVICES</span></h2></div><div><span style="font-family: Poppins;">Identifying deployment services can lead to the access and enumeration of:</span></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;">Unattended answer files<br /><br /></span></li><li><span style="font-family: Poppins;">File permissions<br /><br /></span></li><li><span style="font-family: Poppins;">Included updates<br /><br /></span></li><li><span style="font-family: Poppins;">Applications and versions</span></li></ul><div><span style="font-family: Poppins;">This information can be exploited to penetrate a client's network and hosts. Modifying repositories and service configurations could enable:</span></div></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;">Backdoor installations<br /><br /></span></li><li><span style="font-family: Poppins;">Service modifications, making them vulnerable to attack</span></li></ul><div><h2><span style="font-family: Oswald; font-weight: normal;">CERTIFICATE AUTHORITIES (CAs)</span></h2></div></div><div><span style="font-family: Poppins;">Identifying a Certificate Authority (CA) services on a compromised client host provides access to critical assets, including:</span></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;">Root CA certificates<br /><br /></span></li><li><span style="font-family: Poppins;">Code signing certificates<br /><br /></span></li><li><span style="font-family: Poppins;">Encryption and digital signing certificates</span></li></ul><div><span style="font-family: Poppins;">Gaining control over the CA service also enables the following actions:</span></div></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;">Creation of new certificates for various purposes<br /><br /></span></li><li><span style="font-family: Poppins;">Revocation of existing certificates<br /><br /></span></li><li><span style="font-family: Poppins;">Modification of the Certificate Revocation List (CRL)<br /><br /></span></li><li><span style="font-family: Poppins;">Insertion of a malicious Root CA certificate</span></li></ul><div><span style="font-family: Poppins;">Controlling the CA service poses significant risks, as it can compromise the integrity and security of data and services on a client's network and hosts.</span></div></div><div><h2><span style="font-family: Oswald; font-weight: normal;">SOURCE CODE MANAGEMENT SERVER</span></h2></div><div><span style="font-family: Poppins;">Identifying source code management systems on a compromised host or through the client service offers the following opportunities:</span></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;"><b>Enumerate projects: </b>Project names can reveal sensitive information about the company's ongoing or future projects.<br /><br /></span></li><li><span style="font-family: Poppins;"><b>Verify access to source code files: </b>Confirming access to the code can lead to unauthorized changes.<br /><br /></span></li><li><span style="font-family: Poppins;"><b>Modify source code files: </b>If modification is within scope, an attacker could alter code, potentially impacting system functionality and security.<br /><br /></span></li><li><span style="font-family: Poppins;"><b>Enumerate developers: </b>Developer details can be exploited for social engineering attacks or to aid in compromising other areas of the system or network.<br /><br /></span></li><li><span style="font-family: Poppins;"><b>Enumerate configuration: </b>Accessing configuration data provides insights into the setup and potential vulnerabilities within the system or network.</span></li></ul><div><h2><span style="font-family: Oswald; font-weight: normal;">DYNAMIC HOST CONFIGURATION PROTOCOL (DHCP) SERVER</span></h2></div></div><div><span style="font-family: Poppins;">Identifying a dynamic host configuration service or utilizing it on a compromised host provides the ability to:</span></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;"><b>Enumerate leases given: </b>Identify which devices have been assigned IP addresses.<br /><br /></span></li><li><span style="font-family: Poppins;"><b>Enumerate configuration: </b>Review the configuration settings of the DHCP service.<br /><br /></span></li><li><span style="font-family: Poppins;"><b>Enumerate options: </b>Identify additional settings or options configured within the DHCP service.<br /><br /></span></li><li><span style="font-family: Poppins;"><b>Modify configuration: </b>Altering DHCP settings could disrupt network functionality.<br /><br /></span></li><li><span style="font-family: Poppins;"><b>Consume all leases: </b>Consuming all available IP leases can exhaust the pool of available addresses, leading to network issues.</span></li></ul><div><span style="font-family: Poppins;">Control of the DHCP service poses major risks, including D/DoS or MiTM attacks, allowing attackers to intercept or redirect network traffic between hosts and services on the compromised network.</span></div></div><div><h2><span style="font-family: Oswald; font-weight: normal;">NETWORK TRAFFIC CAPTURE</span></h2></div><div><span style="font-family: Poppins;">Network traffic capture refers to the process of monitoring and recording data packets traveling across a network. This technique can be employed based on the network's security controls, mechanisms in place, and the mediums used for capturing traffic, such as packet sniffers, or intrusion detection systems (IDSs). It serves as a valuable tool for various purposes when it comes to penetration testing, security assessments, vulnerability management, or network troubleshooting. The following are some key areas where network traffic captures can be applied:</span></div><div><ul style="text-align: left;"><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Identify Hosts on the Network</span>: </b>Network traffic capture can reveal active devices and systems on the network. This process allows for reconnaissance, information gathering, and footprinting, which are essential for understanding the layout of any network (target or client). By analyzing traffic, attackers or security analysts can map out the network structure, identifying which hosts are connected, their IP addresses, and communication patterns.<br /><br /></span></li><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Intercept Data</span>: </b>Capturing network traffic enables the interception of data as it travels across the wire. This can involve malicious, unethical, or downright illegal activities such as eavesdropping on sensitive information, performing man-in-the-middle (MiTM) attacks, or gaining unauthorized access to data-in-transit. Such interception can lead to the exposure of confidential communications, credentials, or private information if the data is not adequately encrypted.<br /><br /></span></li><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Identify Services</span>: </b>Through traffic capture, is it 100% possible to identify services running on different hosts within a target or client network. This includes identifying open ports, protocols in use, and potentially vulnerable versions of software, operating systems, firmware, or services. This reconnaissance helps in understanding the system's weaknesses, revealing the networks attack surface, weak points, gaps, flaws, deficiencies and attack vectors, which can be exploited easily if a security flaw of any kind, big or small, is found.<br /><br /></span></li><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Determine Relationships Between Hosts in the Network</span>: </b>By analyzing network traffic, one can determine the relationships between various devices, helping in network topology correlation and diagramming. This process is known as network blueprinting or mapping, and it involves identifying how devices communicate across LANs or WANs, which can highlight network segmentation, critical systems, and potential points of failure or attack.<br /><br /></span></li><li><span style="font-family: Poppins;"><b><span style="font-size: medium;">Capture Credentials</span>: </b>One of the most significant risks of network traffic capture is the sheer ability to intercept sensitive data such as usernames, passwords, and authentication tokens. This is often done through network sniffing tools, which capture network packets that contain credentials normally stored in plaintext, unencrypted. If conducted maliciously, this can lead to unauthorized access, network intrusions, data breaches, and leaks of confidential information.</span></li></ul><div><h2><span style="font-family: Oswald;"><span style="font-weight: 400;">LEGAL AND ETHICAL CONSIDERATIONS</span></span></h2></div><div><span style="font-family: Poppins;">It is essential to approach network traffic capture with caution. Only traffic that is within the scope of the engagement should be captured, and care must be taken to ensure compliance with applicable laws, regulations, and your client's internal operating procedures and policies. Unauthorized interception of network traffic, such as capturing Voice over IP (VoIP) calls or other personal data, can violate privacy laws and lead to legal consequences, fines, or penalties. Additionally, any captured data should be filtered and anonymized to protect the privacy of clients, stakeholders, employees, and users involved. Ethical considerations must guide the use of network traffic capture, ensuring that it is only used and done for legitimate, authorized purposes, such as security assessment, testing, or network management.</span></div></div>
