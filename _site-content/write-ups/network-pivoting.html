Penetration testing also known as pentesting is a crucial security assessment methodology used to identify vulnerabilities in computer systems, networks, and applications. This form of testing simulates real-world cyberattacks to evaluate an organization's defenses and uncover potential entry points for malicious actors. Penetration testers assume the role of attackers to find weaknesses that may have gone unnoticed through traditional security measures.<div><br /></div><div>In this write-up, we'll explore the concept of network pivoting, its types, and how to properly implement it in penetration testing context, using various tools and techniques for effective and stealthy exploitation.<br /><div><br /></div><div>The introduction will cover the following key aspects:</div><div><br /></div><div>1. Definition and purpose of penetration testing.</div><div>2. Types of pentesting methodologies (black box, white box, grey box)</div><div>3. What can be analyzed through penetration testing</div><div>4. OWASP recommended steps for penetration testing</div><div>5. Benefits of regular penetration testing</div><div>6. Different types of penetration testing (network, web application, wireless, physical)</div><div>7. Common tools used in penetration testing</div><div>8. Best practices for effective penetration testing</div><div>9. Future trends in penetration testing technology</div><div>&nbsp;</div><div>This overview provides a comprehensive foundation for understanding the concept and importance of penetration testing in modern cybersecurity practices.</div><div><br /></div><div>Introduction to Network Pivoting</div><div><br /></div><div>Network pivoting is a technique used in penetration testing and red teaming to gain access to systems or networks that are otherwise hidden or isolated. It allows an attacker to use a compromised machine as a stepping stone to reach additional, protected networks that are not directly accessible from the attacker's starting position. Properly executing network pivoting can significantly increase the reach of an attacker during a penetration test or a malicious attack.</div><div><br /></div><div>There are two types of pivoting techniques commonly used in penetration testing: <b>single pivoting</b>&nbsp;and <b>double pivoting.</b></div><div><br /></div><div><div>Single Pivoting</div><div><br /></div><div><b>Single pivoting </b>allows an attacker to use a compromised system as a jumping-off point to access another network that might not be directly reachable from the attacker's original location.</div><div><br /></div><div>1. Drop 3proxy.exe to remove potential conflicts</div><div><ul style="text-align: left;"><li>3proxy.exe is a proxy software that allows an individual to route their network traffic through a compromised machine. Dropping this file could be an attempt to clear any previously set proxy configurations that might interfere with the current pivoting setup.</li></ul></div><div>2. Set up a config file for ProxyChains:</div><div><br /></div><div>allow *_</div><div>internal IP_SAME_NETWORK</div><div>external IP_OTHER_NETWORK</div><div>socks -p1081</div><div><ul style="text-align: left;"><li>ProxyChains is a tool used to force network traffic through proxies (like socks or HTTP). The configuration breakdown is as such:</li><ul><li>allow *_: Allows connections from any source</li><li>internal IP_</li></ul></ul></div><div><br /></div><div>3. Edit /etc/proxychains.conf to add:</div><div><br /></div><div>socks4 IP_SAME_NETWORK 1081</div><div><br /></div><div>4.Scan target network:</div><div><br /></div><div>proxychains nmap -sT -Pn IP_OTHER_NETWORK-250 --top-ports=5</div><div><br /></div><div>Double Pivoting</div><div><br /></div><div>1. Create initial dynamic port forwarding:</div><div><br /></div><div>ssh -f -N -D 9050 root@10.1.2.1</div><div><br /></div><div>2. Edit /etc/proxychains,conf to use 9050 as default gateway</div><div>3. Create second dynamic port forwarding:</div><div><br /></div><div>proxychains ssh -f -N -D 10050 root@10.1.2.1 -p 22</div><div><br /></div><div>4. Edit /etc/proxychains.conf again to use 10050 as default gateway</div><div>5. Use proxychains to pivot to target network:</div><div><br /></div><div>proxychains nmap -sTV -n -PN 10.1.2.1 -254</div><div><br /></div><div>Key Points</div><div><br /></div><div>Pivoting allows access to hidden networks through compromised systems</div><div>Tools like ProxyChains and Metasploit modules facilitate pivoting</div><div>Port forwarding enables accessing services on target systems</div><div>Techniques include SSH brute-forcing and exploiting vulnerabilities like MS08-067</div><div>Double pivoting extends reach across multiple network segments</div></div></div>
